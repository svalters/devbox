# vim: set foldmarker=[[,]] foldlevel=0 foldmethod=marker spell:
# ------------------------------------------------------------------------------
# -> Base image [[
# ------------------------------------------------------------------------------

FROM python:latest

# ]]
# ------------------------------------------------------------------------------
# -> Install base packages [[
# ------------------------------------------------------------------------------

RUN apt-get update && apt-get install -y \
    git \
    mercurial \
    wget \
    curl \
    ssmtp

# ]]
# ------------------------------------------------------------------------------
# -> Install Python packages [[
# ------------------------------------------------------------------------------

RUN pip install \
    uwsgi \
    pipenv

# ]]
# ------------------------------------------------------------------------------
# -> Configure [[
# ------------------------------------------------------------------------------

# Set up uwsgi config list
COPY uwsgi /etc/uwsgi

# Change working directory
WORKDIR /var/www/project

# ]]
# ------------------------------------------------------------------------------
# -> Users [[
# ------------------------------------------------------------------------------

# Add & change user uid
RUN useradd --shell /bin/bash -u 1024 -o -c "" -m devbox
RUN usermod -u 1000 devbox

USER devbox

# ]]
# ------------------------------------------------------------------------------
# -> Environments [[
# ------------------------------------------------------------------------------

# Create tmp dir
RUN mkdir ~/tmp

# Pipenv settings
RUN echo 'export PIPENV_VENV_IN_PROJECT=1' >> ~/.bashrc

# ]]
# ------------------------------------------------------------------------------
